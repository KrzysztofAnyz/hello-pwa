<!DOCTYPE html>
<html>
  <head>
    <title>Google Maps JavaScript API Example</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBJDw3sqV8xEFO_AH0xy4ZnzX2CfFWTXLk&libraries=places"></script>
  </head>
  <body>
    <div class="container">
      <h1 onclick="window.location.href = 'index.html'" class="title">Hello World!</h1>
      <button class="button" onclick="vibrate()">Wibracje-test</button>
      <a href="mapa.html"><button class="button">Mapa</button></a>
      <a href="newwindow.html"><button class="button">NEW WINDOW TEST2</button></a>
    </div>
    <div id="map" style="height: 800px; width: 400px;"></div>
    <script>
      // Initialize the map
      var map;
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: currentLocation,
          zoom: 13
        });
    
        // Create a places service object to search for places
        var service = new google.maps.places.PlacesService(map);
    
        // Define the request parameters
        var request = {
          query: 'mechanic',
          location: map.getCenter(),
          radius: '500'
        };
    
        // Search for the restaurants
        service.textSearch(request, function(results, status) {
          if (status == google.maps.places.PlacesServiceStatus.OK) {
            for (var i = 0; i < results.length; i++) {
              // Create a marker for each restaurant
              var marker = new google.maps.Marker({
                position: results[i].geometry.location,
                map: map,
                title: results[i].name
              });
            }
          }
        });
      }
      
      let currentLocation = {
        lat: 0,
        lng: 0
      };
      
      function getCurrentLocation() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(function(position) {
            currentLocation.lat = position.coords.latitude;
            currentLocation.lng = position.coords.longitude;
            initMap();
          }, function() {
            // Handle Geolocation error
          });
        } else {
          // Browser doesn't support Geolocation
        }
      }
      
      getCurrentLocation();
    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBJDw3sqV8xEFO_AH0xy4ZnzX2CfFWTXLk&libraries=places&callback=initMap"></script>
  </body>
</html>