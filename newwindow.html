<!DOCTYPE html>
<html>
  <head>
    <title>Google Maps JavaScript API Example</title>
    <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/leaflet.min.css" integrity="1xoFisiGdy9nvho8EgXuXvnpR5GAMSjFwp40gSRE3NwdUdIMIKuPa7bqoUhLD0O/5tPNhteAsE5XyyMi5reQVA==" crossorigin="anonymous" />
  <link rel="stylesheet" href="css/style.css">
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" href="images/hello-icon-152.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="theme-color" content="white"/>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Hello World">
  <meta name="msapplication-TileImage" content="images/hello-icon-144.png">
  <meta name="msapplication-TileColor" content="#FFFFFF">
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBJDw3sqV8xEFO_AH0xy4ZnzX2CfFWTXLk&libraries=places"></script>
  </head>
  <body>
    <div class="container">
      <h1 onclick="window.location.href = 'index.html'" class="title">Hello World!</h1>
      <button class="button" onclick="vibrate()">Wibracje-test</button>
      <a href="mapa.html"><button class="button">Mapa</button></a>
      <a href="newwindow.html"><button class="button">NEW WINDOW TEST2</button></a>
    </div>
    <div id="map" style="height: 1200px; width: 100%;"></div>
    <script>
      // Initialize the map
      var map;
      function initMap() {
        map = new google.maps.Map(document.getElementById('map'), {
          center: currentLocation,
          zoom: 13
        });
    
        // Create a places service object to search for places
        var service = new google.maps.places.PlacesService(map);
    
        // Define the request parameters
        var request = {
          query: 'Mechanic',
          location: map.getCenter(),
          radius: '500'
        };
    
        // Search for the restaurants
        service.textSearch(request, function(results, status) {
          if (status == google.maps.places.PlacesServiceStatus.OK) {
            for (var i = 0; i < results.length; i++) {
              // Create a marker for each restaurant
              var marker = new google.maps.Marker({
                position: results[i].geometry.location,
                map: map,
                title: results[i].name
              });
            }
          }
        });
      }
      
      let currentLocation = {
        lat: 0,
        lng: 0
      };
      
      function getCurrentLocation() {
        if (navigator.geolocation) {
          navigator.geolocation.getCurrentPosition(function(position) {
            currentLocation.lat = position.coords.latitude;
            currentLocation.lng = position.coords.longitude;
            initMap();
          }, function() {
            // Handle Geolocation error
          });
        } else {
          // Browser doesn't support Geolocation
        }
      }
      
      getCurrentLocation();
    </script>
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBJDw3sqV8xEFO_AH0xy4ZnzX2CfFWTXLk&libraries=places&callback=initMap"></script>
  </body>
</html>